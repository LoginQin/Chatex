(function(){window.client_ip_info=remote_ip_info})();jQuery.noConflict();
(function(b){b(function(){function y(a,i,b,c){if(a.addEventListener)return a.addEventListener(i,b,c),!0;if(a.attachEvent)return a.attachEvent("on"+i,b);a["on"+i]=b}function M(a,i){a.focus();if(document.selection)sel=document.selection.createRange(),sel.text=i;else{var b=a.selectionStart,c=a.scrollTop,e=a.selectionEnd;a.value=a.value.substring(0,b)+i+a.value.substring(e,a.value.length);b+=i.length;a.setSelectionRange(b,b);a.scrollTop=c}}function z(a){var b="";if("string"!=typeof a||0==a.length)return"";
b=a.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");b=b.replace(/ /g,"&nbsp;");b=b.replace(/\'/g,"&#39;");b=b.replace(/\"/g,"&quot;");return b=b.replace(/\n/g,"<br>")}function oa(a){var b="";if("string"!=typeof a||0==a.length)return"";b=a.replace(/&amp;/g,"&");b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&nbsp;/g," ");b=b.replace(/&#39;/g,"'");b=b.replace(/&quot;/g,'"');return b=b.replace(/<br>/g,"\n")}var G=function(a,b,d){a=a+"="+escape(b);0<d&&(b=new Date,
data.setTime(b.getTime+36E5*d),a=a+"; expires="+b.toGMTString());document.cookie=a},pa=function(a,b){if("object"==typeof a){for(var d in a)G(d,a[d]);0<b&&(d=new Date,d.setTime(d.getTime+36E5*b),document.cookie+="; expires="+d.toGMTString())}};window.deleteCookies=function(a){for(var b in a){var d=b,c=new Date;c.setTime(c.getTime()-1E7);document.cookie=d+"=v; expires="+c.toGMTString()}};var aa=function(){for(var a=document.cookie.split("; "),b,d={},c=0;c<a.length;c++)b=a[c].split("="),d[b[0]]=unescape(b[1]);
return d}(),c={},h=function(){var a=window.navigator.userAgent;this.userAgent=a;var b=a.match(/MSIE\s\w+.\w+/i),d=a.match(/firefox\/\w+.\w+/i),c=a.match(/chrome\/\w+.\w+/i),e=a.match(/opera\/\w+/i),g=a.match(/windows nt \w+.\w+/i),f=a.match(/android/i),h=a.match(/iphone/i),k=a.match(/ipad/i),l=a.match(/ucweb/i),m=a.match(/linux/i),H=a.match(/mobile/i),ba=a.match(/safari\/\w+/i);this.OS=a.match(/mac os/i)||g||m||": )";this.browser=d||c||b||e||": )";ba&&!c&&(this.browser=ba||": )");H?(this.mobile=H,
this.mos=h||k||f||": )",this.mbrowser=l||ba||e||f||": )"):this.mbrowser=this.mos=this.mobile="-"};aa.hostname?(c=aa,c.alone="1"==c.alone?1:0,c.animate="1"==c.animate?1:0,c.sound="1"==c.sound?1:0,c.ctrlkey="1"==c.ctrlkey?1:0):(c.name="_",c.gender="Miss",c.sound=1,c.animate=1,c.ctrlkey=1,client_ip_info&&(c.IP_start=client_ip_info.start,c.country=client_ip_info.country,c.province=client_ip_info.province,c.city=client_ip_info.city,c.isp=client_ip_info.isp),h=new h,c.userAgent=h.userAgent,c.Browser=h.browser?
h.browser[0]:h.browser,c.OS=h.OS?h.OS[0]:h.OS,c.mobile=h.mobile?h.mobile[0]:"",c.mos=h.mos?h.mos[0]:"-",c.mbrowser=h.mbrowser?h.mbrowser[0]:"",c.hostname=window.location.hostname,c.href=window.location.href,c.alone=0,c.name=c.Browser,pa(c,720),G("name",c.name));var Ca=b("title").text();b("#IM_setname").val(c.name);b("#IM_setcity").val(c.city);var n=b("#IM_ChatBox .IM_UserTextarea"),s=0,l=c.animate?200:0,N={},qa=b("#WebIM"),ca=0;y(window,"blur",function(){ca=1},!1);var f="",da=b('div[winid="'+f+'"]'),
I=b("#IM_SysMsgBar"),v,w={},t=b("#IM_MiniBox"),ea=b("#IM_MainPanel");NoticeIMG=b("#IM_NoticeIMG");CHATBOXSHOW=!1;var m=new function(){var a,b,d;this.color="#000";this.show=function(c,e,g){if(O||CHATBOXSHOW){if(!CHATBOXSHOW||g){a=u[0].offsetLeft+20;b=300;d=u[0].offsetWidth-50}else{a=A[0].offsetLeft+120;b=A[0].offsetTop+250;d=A[0].offsetWidth-150}I.css({left:a+"px",top:b+"px",width:d+"px",color:this.color});I.children("span").text(c);I.fadeIn(600,function(){"stay"!=e&&setTimeout(function(){I.fadeOut(600)},
e)})}}},ra=function(){b("#IM_setname").val(c.name);b("#IM_setcity").val(c.city);b("#IM_nickname").text(c.name);var a=b("#IM_status");a.removeClass();if(c.alone){a.addClass("IM_alone");a.text("Alone");a.attr("title","\u5f53\u524d\u4e0d\u63a5\u6536\u4efb\u4f55\u6d88\u606f")}else{a.addClass("IM_online");a.text("Online");a.attr("title","\u5f53\u524d\u4e3a\u63a5\u6536\u6d88\u606f\u72b6\u6001")}a=function(a,b,c){a.removeClass();if(b==c){a[0].className="IM_active";a[1].className="IM_unactive"}else{a[1].className=
"IM_active";a[0].className="IM_unactive"}};a(b("#IM_OP_Gender span"),c.gender,"Mr");a(b("#IM_OP_Sound span"),c.sound,1);a(b("#IM_OP_Animation span"),c.animate,1);a(b(".IM_SendTypeOption span"),c.ctrlkey,0)};ra();var sa=function(){NoticeIMG.removeClass();NoticeIMG.addClass("IM_IMG-offline");NoticeIMG.text(";-(");t.children("span").text("Connecting");b("#IM_nickname").css("color","#ccc");m.color="#f00";if(v.match(/master/)){b(".IM_MasterSignOut").remove();b("#IM_Master ul").before('<a class="IM_MasterSignIN" href="javascript:void(0)">\u767b \u5f55</a>');
b("#IM_Master li").removeClass("IM_MasterOnline");b("#IM_Master li").addClass("IM_MasterOffline")}m.show("-=\u5f53\u524d\u4e0e\u670d\u52a1\u5668\u65ad\u5f00=-","stay")},h=function(a,b){a[0].onmouseover=function(){a[0].style.backgroundImage=b[0].style.display!="none"?"url(http://chatex.jit.su:80//theme/blue/images/slide_up.png)":"url(http://chatex.jit.su:80//theme/blue/images/slide_down.png)"};a[0].onmouseout=function(){a[0].style.backgroundImage=""};a.click(function(){b[0].style.display!="none"?b.slideUp(l,
function(){a[0].style.backgroundImage="url(http://chatex.jit.su:80//theme/blue/images/slide_down.png)"}):b.slideDown(l,function(){a[0].style.backgroundImage="url(http://chatex.jit.su:80//theme/blue/images/slide_up.png)";Da(b)})})},fa=b("#IM_Master .IM_category"),ga=b("#IM_Master ul");h(fa,ga);fa=b("#IM_WithU .IM_category");ga=b("#IM_WithU ul");h(fa,ga);var p=b("#IM_SettingBox"),u=b("#IM_MainBox"),P=b("#IM_GroupBox"),Q;b(".IM_home").click(function(){Q=c.animate?"medium":0;P.fadeOut(Q,function(){u[0].style.zIndex=
1E4;P[0].style.zIndex=100;p[0].style.display="none";P[0].style.display=""})});b("#IM_group").click(function(){Q=c.animate?"medium":0;u.fadeOut(Q,function(){P[0].style.zIndex=1E4;u[0].style.zIndex=100;p[0].style.display="none";u[0].style.display=""})});var R,ha;b("div[class='IM_setting']").click(function(){R=u[0].offsetLeft;ha=R+u[0].clientWidth;if(c.animate){p[0].style.display="block";p.animate({left:R,width:219},l)}else{p[0].style.display="block";p[0].style.left=R+"px";p[0].style.width="219px"}});
b("div[class='IM_btn_back']").click(function(){if(c.animate)p.animate({left:ha,width:0},l,function(){p[0].style.display="none"});else{p[0].style.display="none";p[0].style.left=ha+"px";p[0].style.width="0px"}});var S=b("#IM_status"),Ea=function(a){c.alone=a;k.emit("Leave Me Alone",a,function(b){if(b){m.color=a?"#f90":"#0c0";a?m.show('"Alone" means to Not Get Any Message',3E3,"mainbox"):m.show(" Get Message Status ",3E3,"mainbox")}})},ta=function(){S.removeClass();S.toggleClass(function(){return S.text()==
"Online"?"IM_online":"IM_alone"})};ta();S.click(function(){if(b(this).text()=="Online"){b(this).text("Alone");b(this).attr("title","\u5f53\u524d\u4e0d\u63a5\u53d7\u4efb\u4f55\u6d88\u606f");c.alone=1}else{b(this).text("Online");b(this).attr("title","\u5f53\u524d\u4e3a\u63a5\u6536\u6d88\u606f\u72b6\u6001");c.alone=0}G("alone",c.alone);Ea(c.alone);ta()});h=function(a){a.click(function(){a.removeClass();a.toggleClass("IM_unactive");b(this).removeClass();b(this).toggleClass("IM_active")})};h(b("#IM_OP_Gender span"));
h(b("#IM_OP_Sound span"));h(b("#IM_OP_Animation span"));h(b("#IM_ChatBox .IM_SendTypeOption span"));var Da=function(a){var b=a[0].parentNode,d=b.parentNode,j=d.scrollTop,e=b.offsetTop-d.scrollTop-63,g;e>=b.parentNode.clientHeight/2?c.animate?g=setInterval(function(){d.scrollTop<d.scrollHeight-b.parentNode.clientHeight&&d.scrollTop<j-20+e?d.scrollTop=d.scrollTop+40:clearInterval(g)},20):d.scrollTop=d.scrollTop+e:c.animate?g=setInterval(function(){d.scrollTop>0&&d.scrollTop<j+e?d.scrollTop=d.scrollTop-
40:clearInterval(g)},20):d.scrollTop=d.scrollTop-e};b(".IM_btn_save").click(function(){c.gender=b("#IM_OP_Gender .IM_active").text();c.sound=b("#IM_OP_Sound .IM_active").text()=="ON"?1:0;c.animate=b("#IM_OP_Animation .IM_active").text()=="ON"?1:0;c.name=b("#IM_setname").val()?b("#IM_setname").val():"_";c.city=b("#IM_setcity").val()?b("#IM_setcity").val():c.city;b("#IM_nickname").text(c.name);l=c.animate?200:0;Fa(c);c.sessionid.match(/master/i)||pa(c)});b("#IM_ChatBox .IM_SendTypeOption").click(function(){c.ctrlkey=
b("#IM_ChatBox .IM_SendTypeOption .IM_active").attr("value")=="Enter"?0:1;G("ctrlkey",c.ctrlkey)});var r=b("#IM_ChatBox .IM_btn_Send"),J=function(){for(var a=n.val(),i=s=0;i<a.length;i++)s=a.charCodeAt(i)>256?s+2:s+1;a=Math.ceil(s/2);s>0?r.html(a+"<em style='font-size:12px'>/300<em>"):r.text("Send");if(a>300){r[0].style.background="#f00";r.html(a-300+"<em style='font-size:12px'> over</em>")}else r[0].style.background="#43B1FF";s=a;delete a;b("#IM_ChatBox .IM_TB-fontList").blur()};n.keydown(function(a){a=
a||window.event;if(a.keyCode==9){M(n[0],"    ");return false}if(a.keyCode==13){if(c.ctrlkey)if(a.ctrlKey){J();T()}else return true;else if(!c.ctrlkey&&a.ctrlKey)document.selection?M(n[0],"\r\n "):M(n[0],"\n");else{J();T()}return false}}).keyup(function(a){if((a||window.event).keyCode==13){a:{var a=n[0],b=0;if(document.selection){var b=document.selection.createRange(),c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToEnd",b);a.selectionStart=c.text.length-b.text.length;a.selectionEnd=a.selectionStart+
b.text.length;b=a.selectionStart}else if(a.selectionStart||a.selectionStart=="0")b=a.selectionStart;a=a.value;b=b-2;c="";if(document.selection){if(a.charAt(b+3)!="\n"){last_blanks=c;break a}}else if(a.charAt(b+1)!="\n"){last_blanks=c;break a}for(;b>=0;){if(a.charAt(b)=="\n")break;b--}for(b++;b<a.length;){var j=a.charAt(b);if(j==" "||j=="\t")c=c+j;else break;b++}last_blanks=c}M(n[0],last_blanks)}setTimeout(J,300)});n[0].onpaste=function(){setTimeout(J,300)};n.focus(J);r[0].onclick=function(){T();this.blur()};
var ua,K=b("#IM_ChatBox .IM_SendTypeOption");r.hover(function(){K.animate({opacity:1},l);ua=r.html();r.text("Send")},function(){K.animate({opacity:0.5},0);r.html(ua)});K.hover(function(){K.animate({opacity:1},0)},function(){K.animate({opacity:0.5},0)});var U=b('<span class="IM_SendPrompt">\u5728\u8fd9\u91cc\u8f93\u5165\u4fe1\u606f...</span>');b(".IM_btn_Send").before(U);U.click(function(a){a?a.stopPropagation():window.event.cancelBubble=true;n.focus()});y(n[0],"focus",function(){U.fadeOut(l)},!1);
y(n[0],"blur",function(){s==0&&U.show()},!1);var C=b("#IM_ChatBox .IM_TB-fontOption"),ia=b("#IM_ChatBox .IM_TB-fontList"),V=!1,va=function(){if(!V){C[0].style.background="#fff";C[0].style.color="#999"}},wa=function(){C[0].style.background="#E671B8";C[0].style.color="#fff"};C.hover(wa,va);ia.blur(function(){b(this).fadeOut(l);V=false;va()});C.click(function(){if(V)ia.blur();else{ia.fadeIn(l);V=true;wa()}this.blur()});var D;b("#IM_ChatBox .IM_TB-fontList li").click(function(){D=b(this).val();n[0].style.fontSize=
D+"px";b("dd.IM_MsgContent-Get").css("fontSize",D);b("dd.IM_MsgContent-Send").css("fontSize",D)});var x=new function(){var a="",b="",c=[],j=[];this.html_encode=function(a){return z(a)};this.html_decode=function(a){return oa(a)};this.addContentReplaceRule=function(a,b){c.push(a);j.push(b)};this.HandleMsg=function(e){a=e;for(var g,e=0;e<c.length;e++)if(g=a.match(c[e])){matchReg=c[e];handled_Msg=j[e](g);e=a.split(g[0]);b=z(e[0])+g[0].replace(matchReg,handled_Msg)+z(e[1]);break}g||(b=z(a));return b}};
window.IM_ChatModule={addContentReplaceRule:function(a,b){x.addContentReplaceRule(a,b)},html_encode:function(a){return z(a)},html_decode:function(a){return oa(a)}};x.addContentReplaceRule(/#(code|js|javascript|html|java|perl|py|c|cpp|c\+\+|php|jsp|python|bash|sql|xml|css|makefiles|ruby|php|vb)\s[\s\S]*/i,function(a){return'<pre class="prettyprint">'+prettyPrintOne(z(a[0]),a[1])+"</pre>"});x.addContentReplaceRule(/https?:\/\/([-\w\.]+)+(:\d+)?(\/([^\s]*(\?\S+)?)?)?/g,function(a){return'<a href="'+
a[0]+'" target="_blank" style="color:#3399FF; font-style:italic;">'+a[0]+"</a>"});x.addContentReplaceRule(/#douban/,function(){return'<iframe id="runtime"  name="runtime" width="330" height="285" scrolling="no" frameborder="0" src="http://douban.fm/partner/uc"></iframe>'});x.addContentReplaceRule(/(#yd|#\u7ffb\u8bd1|#english|#en|#chinese|#cn)\s([\s\S]+)/,function(a){var c=encodeURI("keyfrom=chinesetiger&key=799841294&type=data&doctype=jsonp&callback=show&version=1.1&q="+a[2]),d=Math.round(Math.random()*
1E14);b.ajax({type:"GET",url:"http://fanyi.youdao.com/openapi.do",data:c,dataType:"jsonp",success:function(a){b('dd[yd="youdao:'+d+'"]').text(a.translation)}});return'<dd yd="youdao:'+d+'">'+z(a[2])+"</dd>"});x.addContentReplaceRule(/#(music|\u97f3\u4e50|xiami|\u867e\u7c73)(=|:|\s)([\s\S]+)/,function(a){var c,d=Math.round(Math.random()*1E15);a[3]&&(c=encodeURI(a[3]));if(c&&c.replace(/\s/g,"")!=""){b.ajax({url:"http://www.xiami.com/app/nineteen/search/key/"+c+"/page/1",data:"random="+(new Date).getTime()+
".js",dataType:"jsonp",success:function(a){var c=b('dd[music="xiami:'+d+'"]');if(a.total==0||a.total=="0"){c.children("em").text("\u867e\u7c73\u65e0\u6cd5\u627e\u5230:");c.children("em").css({fontStyle:"normal",color:"red"});c.append('<p style="color:#999; font-size:11px;">\u8bf7\u68c0\u67e5\u641c\u7d22\u8bcd\u662f\u5426\u6b63\u786e\uff0c\u66f4\u7cbe\u786e\u641c\u7d22\u8bf7\u4f7f\u7528\uff1a\u6b4c\u540d \u827a\u4eba</p>')}else{c.append('<br/><embed src="http://www.xiami.com/widget/0_'+a.results[0].song_id+
'/singlePlayer.swf" type="application/x-shockwave-flash" width="257" height="33" style="margin:5px 0 0 0;" wmode="transparent" ></embed>');c.children("em").text("\u8bf7\u7b49\u5f85\u52a0\u8f7d\u97f3\u4e50:");c.children("em").css({color:"green",fontStyle:"normal"});c.children("span").text(decodeURI(a.results[0].song_name+" - "+a.results[0].artist_name).replace(/\+/g," "));c.children("span").css({color:"#FF5A0B"});setTimeout(function(){c.children("em").text("\u70b9\u51fb\u64ad\u653e:")},2500)}delete c}});
return'<dd music="xiami:'+d+'"><em style="color:#F1960A;font-size:11px;">      \u6b63\u5728\u641c\u7d22\u867e\u7c73\u97f3\u4e50:</em><span style="font-size: 12px; margin: 0 0 0 5px;">'+a[3]+"</span></dd>"}});var T=function(){var a=n.val(),i=function(a){a=a+"";return a.length==1?"0"+a:a};if(a.replace(/\s/g,"").length>0&&s<=300){var d=new Date,i=i(d.getHours())+":"+i(d.getMinutes())+":"+i(d.getSeconds()),d=b('<dl class="IM_MsgBody-Send" />'),j=b('<dt class="IM_MsgHeader-Send" />'),e=b('<dd class="IM_MsgContent-Send" style="font-size:'+
D+'px" />'),g=b("<span />").text(c.name+" "+i),q=b('<em class="IM_MsgSending"> \u25cf\u6b63\u5728\u53d1\u9001</em>'),h=b('<dd class="IM_Msg_footer-Send" />').append("<em><em>"),k=x.HandleMsg(a),l=b("<span />");l.append(k);n.val("");j.append(g);j.append(q);d.append(j);e.append(l);d.append(e);d.append(h);da.append(d);da.scrollTop(1E6);var m=function(){q.removeClass();q.addClass("IM_MsgSendSucess");q.text(" \u25cf\u53d1\u9001\u5230\u8fbe");q.fadeOut(2E3,function(){q.text("");q.removeClass()})},H=function(){q.text(" \u25cf\u53d1\u9001\u5931\u8d25");
q.removeClass();q.addClass("IM_MsgSendfail")};f.match(/group/)?Ga(f,{name:c.name,time:i,msg:a,footer:""},function(a){a?m():H()}):Ha(f,{name:c.name,time:i,msg:a,footer:""},function(a){a?m():H()})}};b(".IM_btn_ChangeWin").live("click",function(){var a=window.open("","newwin","modal=yes,height=570,width=720,left=180,top=40px,location=0,toolbar=0,menubar=0,scrollbars=0,resizable=1,status=0,channelmode=0,directories=0"),c=b("#IM_ChatBox");a.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>WebIM</title><script type="text/javascript">var a = function(arg){document.write(arg)}<\/script></head><body></body></html>');
a.window.a('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>WebIM</title><link id="IM_css" rel="stylesheet" type="text/css" href="blue_openwin.css" /> </head><body><div id="IM_ChatBox">'+c.html()+"</div></body></html>");a.document.close();addMsg=function(){T()}});var k=document.selection?io.connect("http://chatex.jit.su:80",
{rememberTransport:!0,"match origin protocol":!0,"sync disconnect on unload":!0,transports:["htmlfile","xhr-polling","jsonp-polling"]}):io.connect("http://chatex.jit.su:80"),xa=function(a){if(o[a]){var c=b('li[sid="'+a+'"] span').text();b('dd[listid="'+a+'"] span').text(c);b('div[sid="'+a+'"] .IM_TargetState').text(c)}};k.on("connect",function(){m.color="#000";m.show("\u5df2\u8fde\u63a5\u81f3\u670d\u52a1\u5668!",3E3);v=k.socket.sessionid;if(!aa.sessionid){G("sessionid",v);c.sessionid=v}v=c.sessionid;
k.emit("add to online list",c,function(a){var c=b("#IM_Master ul");c.empty();var d,j,e;for(e in a){j="IM_listitem ";d=a[e];j=j+(d.online?"IM_MasterOnline":"IM_MasterOffline");c.append(b('<li class="'+j+'" sid="'+d.masterid+'"></li>').append(b("<span />").text(d.nickname)))}});NoticeIMG.removeClass();NoticeIMG.addClass("IM_IMG-online");NoticeIMG.text(": )");t.children("span").text("chat");b("#IM_nickname").css("color","#43B1FF")});k.on("target disconnect",function(a){if(a.match(/master/i)){var c=b('li[sid="'+
a+'"]');c.removeClass("IM_MasterOnline");c.addClass("IM_MasterOffline")}if(o[a]){b('dd[listid="'+a+'"] span').css({color:"#ccc",textDecoration:"line-through"});b('div[sid="'+a+'"] .IM_TargetState').css({borderLeft:"8px solid #ccc",color:"#ccc"})}});k.on("target reconnect",function(a){if(o[a]){b('dd[listid="'+a+'"] span').css({color:"#000",textDecoration:"none"});b('div[sid="'+a+'"] .IM_TargetState').css({borderLeft:"8px solid #84D747",color:"#000"});a.match(/master/i)&&W(a)}});k.on("update online list",
function(a){b("#IM_WithU");var c=b("#IM_WithU h3"),d=b("#IM_WithU ul"),j=a.total;t.children("span").text(a.total+"\u4eba\u5728\u7ebf");d.empty();var a=a.list,e,g;for(g in a){if(ismaster=a[g].id.match(/master/i)){e=b('li[sid="'+a[g].id+'"]');e.removeClass("IM_MasterOffline");e.children("span").text(a[g].nick);e.addClass("IM_MasterOnline");xa(a[g].id);j--}if(o[a[g].id]){ismaster?e.addClass("IM_chatwith-master"):d.append(b('<li class="IM_listitem IM_Li-chatwith" sid='+a[g].id+"/>").append(b("<span />").text(a[g].nick)).append(b("<abbr />").text(a[g].city)));
xa(a[g].id)}else ismaster||d.append(b('<li class="IM_listitem" sid='+a[g].id+"/>").append(b("<span />").text(a[g].nick)).append(b("<abbr />").text(a[g].city)));j>1?c.text(j+"-Visitors"):c.text(j+"-Visitor")}});k.on("reconnect",function(){m.color="#000";m.show("Reconnect to Server!",2E3)});k.on("disconnect",sa);k.on("error",function(){m.color="#f00";m.show(" -= Connect Error, Server Have No Response! =-","stay");sa()});var Ga=function(a,b,c){k.emit("public message",a,b,c)},Ha=function(a,b,c){k.emit("private message",
a,b,c)},Ia=function(a,b,c,j){var e=function(a,b){a.addClass(b);setTimeout(function(){a.removeClass(b)},300)};e(a,b);c--;var g=setInterval(function(){if(0==c){clearInterval(g);typeof j=="function"&&j()}else{e(a,b);c--}},600)},X,Y,Ja=function(a){if(document.selection)return false;X&&clearInterval(X);Y&&clearTimeout(Y);var c=b("title");c.text(a);X=setInterval(function(){c.text("Message Come!");Y=setTimeout(function(){c.text(a)},500)},1E3);y(window,"focus",function(){ca=0;clearInterval(X);clearTimeout(Y);
c.text(Ca)},false)},Ka=function(a){if(f!=a){var c=b('dd[listid="'+a+'"]');w[a]=w[a]?w[a]+1:1;Ia(c,"IM_ChattingUser-msg",2,function(){c.children("em").text("+"+w[a]);c.addClass("IM_ChattingUser-uncheck")})}},E=function(a,i,d){var j=a.match(/group/i),e=a.match(/master/i);if(!j||N[a]){CHATBOXSHOW||ja();if(!o[a]){var g=0,f;for(f in o){g++;if(f)break}g>0?j?B(a,i.groupname,"notshow"):B(a,i.name,"notshow"):j?B(a,i.groupname):B(a,i.name);e&&W(a)}Ka(a);a!=v&&ca&&Ja(i.name+"-Message Come!");if(a!=v&&c.sound&&
c.mobile=="-")if(document.selection){ya.removeAttr("volume");ya.attr("src","http://chatex.jit.su:80/sound/sms.wav")}else La[0].play();e=b('<dl class="IM_MsgBody-Get" />');g=b('<dt class="IM_MsgHeader-Get" />');f=b('<dd class="IM_MsgContent-Get" style="font-size:'+D+'px" />');a_name=a.match(/group/)?b('<a class="IM_MsgName-Get" tid="'+i.sid+'" href="javascript:void(0)" title="'+("\u70b9\u51fb\u5355\u72ec\u8ddf: "+i.name+" \u804a\u804a~")+'"/>').text(i.name+" "):b('<a class="IM_MsgName-Get" tid="'+
a+'" href="javascript:void(0)" />').text(i.name+" ");span=b("<span />").text(i.time);ddf=b('<dd class="IM_Msg_footer-Get" />').append("<em></em>");b("<span />");var i=x.HandleMsg(i.msg),h=b("<span />");h.append(i);g.append(a_name);g.append(span);e.append(g);f.append(h);e.append(f);e.append(ddf);a=b('div[winid="'+a+'"]');if(a[0].clientHeight==a[0].scrollHeight-a[0].scrollTop){a.append(e);a.scrollTop(a.scrollTop()+1E4)}else a.append(e);j||d(true)}};k.on("public message",E);k.on("private message",E);
k.on("message error",function(a){m.color="#000";m.show(a,4E3)});var Fa=function(a){k.emit("save data",a,function(a){if(a){m.color="#393";m.show("Save Data Success!",2E3,"Mainbox")}})},A=b("#IM_ChatBox"),Ma=b('div[sid="{#sid}"]').html(),L=b("#IM_ChatBox .IM_Chatting-List"),o={},ja=function(){A.fadeIn(l);CHATBOXSHOW=true};b(".IM_listitem span").live("click",function(){f&&b('dd[listid="'+f+'"]').removeClass("IM_Li-chatwith");f=b(this).parent().attr("sid");name=b(this).text();b(this).parent().addClass("IM_Li-chatwith");
CHATBOXSHOW||ja();B(f,name);if(f.match(/group/)&&!N[f]){N[f]=true;k.emit("get group history msg",f,function(a,b){for(var c in b)E(a,b[c])})}if(b(this).parent()[0].className.match(/IM_MasterOffline/i)){b('dd[listid="'+f+'"] span').css({color:"#ccc",textDecoration:"line-through"});b('dd[listid="'+f+'"]').css("borderLeft","3px solid #FFCECE");b('div[sid="'+f+'"] .IM_TargetState').css({borderLeft:"8px solid #ccc",color:"#ccc"})}b(this).parent()[0].className.match(/IM_MasterOnline/i)&&W(f)});var W=function(a){var c=
"#FF3535",d=c;if(b('li[sid="'+a+'"]')[0].className.match(/offline/i)){c="#ccc";d="#FFCECE"}b('dd[listid="'+a+'"]').css({borderLeft:"3px solid "+d});b('div[sid="'+a+'"] .IM_TargetState').css({borderLeft:"8px solid "+c})};b("a.IM_MsgName-Get").live({click:function(){b('dd[listid="'+f+'"]').removeClass("IM_Li-chatwith");f=b(this).attr("tid");B(f,b(this).text());b('li[sid="'+f+'"]').addClass("IM_Li-chatwith");f.match(/master/i)&&W(f)},mouseover:function(){}});var ka=function(a){if(o[a]){f=a;b("#IM_ChatBox .IM_WinBottom").css("opacity",
0);b(".IM_PersonWin").css({opacity:0,display:"block",position:"absolute",top:0,width:"380px",zIndex:1});o[f].css({opacity:1,zIndex:1E3});b('dd[listid="'+f+'"]').addClass("IM_Li-chatwith");da=b('div[winid="'+f+'"]')}},B=function(a,c,d){var f=Ma.replace(/\{#sid\}/g,a),e=a.match(/group/i),c=e?c+":Group":c,g=e?"IM_ChattingUser IM_ChattingGroup":"IM_ChattingUser",f=f.replace(/\{#groupstate\}/g,e?"IM_State-Group":""),f=f.replace(/\{#name\}/g,c);if(!o[a]){b("#IM_ChatBox .IM_WinBottom").before('<div class=IM_PersonWin sid="'+
a+'">'+f+"</div>");o[a]=b('div[sid="'+a+'"]');L.append('<dd listid="'+a+'" class="'+g+'"><span>'+c+'</span><em></em><a href="javascript:void(0)">x</a></dd>')}d||ka(a)};b(".IM_ChattingUser span").live("click",function(){var a=b(this).parent().attr("listid"),c=b(this).parent();b('dd[listid="'+f+'"]').removeClass("IM_Li-chatwith");ka(a);setTimeout(function(){c.children("em").text("");if(w[a]){c.removeClass("IM_ChattingUser-uncheck");w[a]=0}},1E3)});var za=function(a){o[a].remove();delete o[a];w[a]&&
delete w[a];var b=[],c;for(c in o)b.push(c);if(b.length==0){A.hide();CHATBOXSHOW=false;I.hide()}f==a&&ka(b[b.length-1])};b(".IM_UserWinclose").live("click",function(){var a=b(this).attr("closeid");if(a.match(/group/i)){if(!confirm("\u5173\u95ed\u7fa4\u540e\u5c06\u4e0d\u4f1a\u63a5\u6536\u8be5\u7fa4\u6d88\u606f, \u670d\u52a1\u5668\u53ea\u4f1a\u4fdd\u5b58\u6700\u8fd150\u6761\u4e0a\u4e0b\u6587\u4fe1\u606f, \u771f\u7684\u8981\u5173\u95ed\u7fa4\u5417? "))return;delete N[a]}za(a);b('li[sid="'+a+'"]').removeClass("IM_Li-chatwith");
b('dd[listid="'+a+'"]').remove()});b(".IM_ChattingUser a").live("click",function(){var a=b(this).parent().attr("listid");b(this).parent().remove();b('li[sid="'+a+'"]').removeClass("IM_Li-chatwith");za(a)});var Z=b("#IM_Recently-List"),la=b("#IM_Recently"),$=b("#IM_ChatBox .IM_ChatList h3");la.click(function(){$.animate({fontSize:"11px"},"fast",function(){$[0].style.color="#ccc"});b(this).addClass("IM_Recent-active");b(this).animate({fontSize:"15px",left:"30px"},"fast");L.animate({width:"0"},"fast");
L.hide();Z.show();Z.animate({left:"1px",width:"100px"},"fast")});$.click(function(){la.animate({fontSize:"10px",left:"50px"},"fast",function(){la.removeClass("IM_Recent-active")});b(this).animate({fontSize:"16px"},"fast",function(){$[0].style.color="#000"});Z.animate({left:"100px",width:"0"},"fast");Z.hide();L.animate({width:"100px"},"fast");L.fadeIn("fast")});(function(a,c){var d=0-b("#WebIM")[0].offsetLeft,f=0-b("#WebIM")[0].offsetTop,e,g,h,k=function(a){var b;if(document.selection){b=a.clientX;
a=a.clientY}else{b=a.pageX;a=a.pageY}return{X:b,Y:a}};y(document,"mousemove",function(a){h=k(a||window.event);if(n){e=h.X-m;g=h.Y-l;e=e>d?e:d;e=e>220?220:e;g=g>f?g:f;g=g>45?45:g;c.css({left:e,top:g})}},false);y(document,"mouseup",function(){if(n){c.css({left:e,top:g});n=false;document.selection&&document.selection.empty&&(document.selection.empty(),1)||window.getSelection&&window.getSelection().removeAllRanges()}},false);var l,m,n=false;a.live({mousedown:function(a){h=k(a||window.event);d=0-b("#WebIM")[0].offsetLeft;
f=0-b("#WebIM")[0].offsetTop;m=h.X-c[0].offsetLeft;l=h.Y-c[0].offsetTop;b(this).css({cursor:"move"});n=true}})})(b(".IM_ChattingTitle"),A);t.children("b");var O=0;t.click(function(){t.fadeOut(l);ea.fadeIn(l);O=1;b(".IM_Li-chatwith").length&&ja()});t.hover(function(){NoticeIMG.addClass("IM_IMG-hover")},function(){NoticeIMG.removeClass("IM_IMG-hover")});b(".IM_MinBar").click(function(){ea.hide();O=0;t.fadeIn(l)});b(".IM_MinSizeWin").live("click",function(){ea.hide();O=0;A.hide();CHATBOXSHOW=false;t.fadeIn(l)});
TargetInfo=b("#IM_TargetInfo");var Aa,ma=[],Ba=function(a){for(var b=0;b<a.length;b++)clearInterval(a.pop())},Na=function(a){if(!a.match(/group/)&&!a.match(/master/)){var b,c;c=(new Date).getTime();Aa=setInterval(function(){b=(new Date).getTime();if(b-c>500){TargetInfo.fadeTo(l,0.9);k.emit("get user info",a);TargetInfo.children("dl").remove();TargetInfo.append("<dl><dt>User Info</dt><dd><b>Getting Data...</b></dd></dl>");Ba(ma)}},100);ma.push(Aa)}};k.on("get user info",function(a){TargetInfo.children("dl").remove();
a.IP_start=a.IP_start.split(".");a.IP_start[2]=a.IP_start[3]="*";TargetInfo.append("<dl><dt>User Info</dt><dd><b>Name </b><span>"+a.name+"</span></dd><dd><b>Gender </b>"+a.gender+"</dd><dd><b>Browser </b>"+a.Browser+"</dd><dd><b>Mobile </b>"+a.mos+"</dd><dd><b>OS </b>"+a.OS+"</dd><dd><b>ISP</b>"+a.isp+"</dd><dd><b>IP </b>"+a.IP_start.join(". ")+"</dd><dd><b>Position </b><span>"+a.city+" "+a.province+" "+a.country+"</span></dd></dl>")});(function(){c.mobile=="-"&&b(".IM_listitem span").live({mouseover:function(){TargetInfo.css({top:b(this).parent()[0].offsetTop-
b(this).parents(".IM_content").scrollTop()+"px",right:"-"+(u[0].offsetLeft-5)+"px",display:"none"});Na(b(this).parent().attr("sid"))},mouseout:function(){TargetInfo.hide();Ba(ma)}})})();(function(a){document.selection?qa.append('<bgsound id="IM_bgsound" volume="-5000" src="http://chatex.jit.su:80/'+a+'" />'):qa.append('<audio preload="auto" src="http://chatex.jit.su:80/'+a+'" id="IM_audio"></audio>')})("sound/sms.wav");var La=b("#IM_audio"),ya=b("#IM_bgsound"),F=b("#IM_DialoBox");b(".IM_MasterSignIN").click(function(){F.fadeIn(l)});
b(".IM_DialoClose").click(function(){F.fadeOut(l)});b("#IM_btn_SignIn").click(function(){var a=b("#IM_SignInName").val().replace(" ",""),f=b("#IM_SignInPw").val().replace(" ",""),d=function(){F.animate({left:"20px"},160,function(){F.animate({left:"130px"},320,function(){F.animate({left:"100px"},160,function(){setTimeout(function(){b("#IM_SignInPw").val("")},300)})})})};a==""&&f==""?d():k.emit("Master Sign In",{name:a,pw:f},function(a,e){if(a){m.color="#39f";m.show("Welcome Back:"+e.nickname,3E3,"mainbox");
deleteCookies(c);b(".IM_MasterSignIN").remove();b(".IM_MasterSignOut").show();c.name=e.nickname;c.gender=e.gender;c.city=e.city;c.sound=parseInt(e.sound);c.animate=parseInt(e.animate);c.alone=parseInt(e.alone);c.sessionid=v=e.masterid;ra();F.fadeOut(l);if(e.MasterMsg){var f=e.MasterMsg,h;for(h in f)E(f[h].from,f[h].data,function(){})}}else d()})});b("#IM_Tutorial").click(function(){f="tutorial";if(!o[f]){B(f,"\u6559\u7a0b");var a=1;E(f,na[0],function(){a++});var b=setInterval(function(){a<na.length?
o.tutorial?E(f,na[a],function(){a++}):window.clearInterval(b):window.clearInterval(b)},8E3)}});var na=[{name:"\u52a9\u624b",msg:'\u4f60\u597d : ) \r\n\u6b22\u8fce\u4f7f\u7528 No2Chat ( \u610f\u601d\u662fNot Only To Chat \u54e6) \r\n\u6211\u662f\u6559\u7a0b\u5c0f\u52a9\u624b, \u4e0b\u9762\u8ba9\u6211\u6765\u4ecb\u7ecdNo2Chat\u6240\u542b\u6709\u7684\u529f\u80fd\u5427~ \r\n\u4ed4\u7ec6\u7684\u770b\u4e00\u4e0b\u5e2e\u52a9, \u76f8\u4fe1\u4f1a\u8ba9\u4f60\u66f4\u597d\u7684\u4f7f\u7528\u54e6~"',time:"",
footer:""},{name:"\u52a9\u624b",msg:"No2Chat\u88ab\u8bbe\u8ba1\u4e3a\u4e00\u4e2a\u6781\u9ad8\u6027\u80fd\u7684\u7f51\u9875\u5b9e\u65f6\u804a\u5929\u5de5\u5177, \u5e76\u4e14\u53ef\u4ee5\u975e\u5e38\u5bb9\u6613\u5b89\u88c5\u5230\u9700\u8981\u62e5\u6709\u5b9e\u65f6\u804a\u5929\u529f\u80fd\u7684\u7f51\u7ad9\u4e2d, \u6bd4\u5982\u535a\u5ba2,\u6216\u8005\u662f\u5ba2\u670d\u7cfb\u7edf,\u5728\u7ebf\u54a8\u8be2\u7b49.",time:"",footer:""},{name:"\u52a9\u624b",msg:'\u73b0\u5728\u5047\u5982No2Chat\u5b89\u88c5\u5728\u4e00\u4e2a\u6280\u672f\u725b\u4eba\u535a\u5ba2\u4e0a, \u5728\u4e3b\u9762\u677f\u4e2d"Master"\u4e00\u680f\u770b\u5230\u7684\u662f\u535a\u4e3b\u662f\u5426\u5728\u7ebf(\u5728\u7ebf\u4e3a\u7ea2\u8272), \u5982\u679c\u535a\u4e3b\u4e0d\u5728\u7ebf,\u4f60\u8fd8\u53ef\u4ee5\u8ddf\u5f53\u524d\u4e0e\u4f60\u4e00\u8d77\u6d4f\u89c8\u8be5\u7f51\u7ad9\u7684\u4eba\u6c9f\u901a\u54e6.',
time:"",footer:""},{name:"\u52a9\u624b",msg:"\u65e2\u7136\u662f\u6280\u672f\u535a\u5ba2, \u8bd5\u8bd5\u804a\u804a\u4ee3\u7801, \u4f60\u53ef\u4ee5\u7528\r\n#code+\u7a7a\u767d+\u4f60\u7684\u4ee3\u7801\r\n\u6765\u5e2e\u4f60\u8fdb\u884c\u4ee3\u7801\u9ad8\u4eae~",time:"",footer:""},{name:"\u52a9\u624b",msg:'\u4f8b\u5982:#code \r\n function(){\r\n alert("OK?");\r\n}',time:"",footer:""},{name:"\u52a9\u624b",msg:"\u5f53\u7136\u5566,\u6211\u4eec\u5efa\u8bae,\u5982\u679c\u4f60\u660e\u786e\u7684\u77e5\u9053\u4f60\u7684\u4ee3\u7801\u7c7b\u578b,\u53ef\u4ee5\u7528\r\n#\u4ee3\u7801\u7c7b\u578b \u6765\u6807\u8bc6. ",
time:"",footer:""},{name:"\u52a9\u624b",msg:'\u4f8b\u5982\u7528\r\n"#html"\u6765\u53d6\u4ee3"#code", \u8ba9\u7a0b\u5e8f\u7528html\u7684\u8bed\u6cd5\u6765\u9ad8\u4eae\u4f60\u7684\u4ee3\u7801, \u8fd9\u6837\u4e0d\u4ec5\u4fdd\u8bc1\u7a0b\u5e8f\u9ad8\u4eae\u6b63\u786e,\u800c\u4e14\u4e5f\u5f88\u65b9\u4fbf\u5bf9\u65b9\u770b\u51fa\u4f60\u5199\u7684\u4ec0\u4e48\u7c7b\u578b\u7684\u4ee3\u7801.\r\n',time:"",footer:""},{name:"\u52a9\u624b",msg:'\u5982:#html \r\n<script>\r\n  alert("adfs");\r\n<\/script>',time:"",
footer:""},{name:"\u52a9\u624b",msg:"\u4ee3\u7801\u9ad8\u4eae\u57fa\u4e8e\u8c37\u6b4c\u7684PrettyCode,\u652f\u6301\u5927\u591a\u6570\u7684\u8bed\u8a00\u7c7b\u578b.",time:"",footer:""},{name:"\u52a9\u624b",msg:"\u5bf9\u4e86, \u8f93\u5165\u6846\u662f\u652f\u6301Tab\u53ca\u7b80\u5355\u7684\u81ea\u52a8\u7f29\u8fdb\u54e6!",time:"",footer:""},{name:"\u52a9\u624b",msg:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7a0b\u5e8f\u4e5f\u5339\u914d\u4e86\u8d85\u94fe\u63a5\r\n\u4f8b\u5982\u4f60\u8fd8\u53ef\u4ee5\u8f93\u5165\r\nhttp://weibo.com/chinesetiger/\r\n\u6765\u53d1\u9001\u94fe\u63a5\u7ed9\u5bf9\u65b9\u54e6, \u8fd9\u662f\u6211\u4e3b\u4eba\u7684\u5fae\u535a\u5730\u5740.",
time:"",footer:""},{name:"\u52a9\u624b",msg:"No2Chat\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u63a5\u53e3\u6765\u8ba9\u4f60\u521b\u5efa\u65b0\u7684\u6a21\u5f0f\u6765\u81ea\u5b9a\u4e49\u5339\u914d\u7528\u6237\u6d88\u606f, \u8fd9\u6837\u53ef\u4ee5\u6839\u636e\u4f60\u7684\u7f51\u7ad9\u5b9e\u9645\u60c5\u51b5\u6765\u521b\u5efa\u65b0\u7684\u5339\u914d, \u4e3a\u804a\u5929\u6dfb\u52a0\u66f4\u591a\u4e30\u5bcc\u7684\u529f\u80fd~",time:"",footer:""},{name:"\u52a9\u624b",msg:"\u4e3a\u4e86\u65b9\u4fbf,No2Chat\u8fd8\u7528\u989c\u8272\u6765\u6807\u8bc6\u4e0d\u540c\u7684\u804a\u5929\u5bf9\u8c61 \r\n\u6bd4\u5982:\r\n\u7eff\u8272-\u5f53\u524d\u804a\u5929\u5bf9\u8c61,\u7ea2\u8272-\u4e3b\u4eba,\u5ba2\u670d,\u535a\u4e3b\u7b49\u7b49,\u8fd8\u6709\u84dd\u8272-\u7fa4",
time:"",footer:""},{name:"\u52a9\u624b",msg:"*\u6bcf\u4e00\u4e2a\u767b\u9646\u7684\u7528\u6237\u81ea\u52a8\u52a0\u5165\u8be5\u7f51\u7ad9\u7684\u9ed8\u8ba4\u7fa4 \r\n\u5982\u679c\u4f60\u8981\u67e5\u770b\u5e76\u63a5\u6536\u7fa4\u6d88\u606f, \u6253\u5f00\u7fa4\u804a\u5bf9\u8bdd\u6846\u5373\u53ef \r\n\u5173\u95ed\u540e\u8868\u793a\u4f60\u4e0d\u60f3\u63a5\u6536\u7fa4\u6d88\u606f\u54e6~\u7cfb\u7edf\u5c06\u4e0d\u4f1a\u63a5\u53d7\u7fa4\u6d88\u606f~",time:"",footer:""},{name:"\u52a9\u624b",msg:"*\u5728\u7fa4\u804a\u4e2d\u5982\u679c\u5bf9\u67d0\u4eba\u611f\u5174\u8da3,\u53ef\u4ee5\u70b9\u51fb\u5bf9\u65b9\u540d\u5b57\u5feb\u901f\u521b\u5efa\u79c1\u804a~",
time:"",footer:""},{name:"\u52a9\u624b",msg:"\u5982\u679c\u4f60\u4e0d\u5c0f\u5fc3\u6389\u7ebf\u4e86, 10\u5206\u949f\u5185\u518d\u6b21\u767b\u9646\u8be5\u7f51\u7ad9\u8fd8\u53ef\u4ee5\u67e5\u770b\u4f60\u6ca1\u6709\u6536\u5230\u7684\u6d88\u606f~\u5f53\u7136\u9700\u8981\u6253\u5f00\u6d4f\u89c8\u5668Cookie\u529f\u80fd,\u5426\u5219\u670d\u52a1\u5668\u4e0d\u8ba4\u8bc6\u4f60\u5566",time:"",footer:""},{name:"\u52a9\u624b",msg:"\u5982\u679c\u4f60\u662fMaster, \u4f60\u6c38\u8fdc\u4e5f\u4e0d\u7528\u62c5\u5fc3\u6389\u7ebf\u6216\u8005\u63a5\u6536\u6d88\u606f\u4e0d\u5230,\u4f60\u7684\u6d88\u606f\u662f\u5b58\u5728\u670d\u52a1\u5668\u4e0a\u7684\u54e6.",
time:"",footer:""},{name:"\u52a9\u624b",msg:"\u5982\u679c\u4f60\u60f3\u8bd5\u9a8c#\u53f7\u529f\u80fd\uff0c\u800c\u4e0d\u6253\u6270\u5176\u4ed6\u4eba\uff0c\u53ef\u4ee5\u901a\u8fc7\u7ed9\u81ea\u5df1\u53d1\u6d88\u606f\u5b66\u4e60\u54e6\uff0c\u719f\u6089\u4e86\u518d\u8ddf\u4ed6\u4eba\u4f7f\u7528No2Chat\u5427 ~^_^~",time:"",footer:""},{name:"\u52a9\u624b",msg:"\u597d\u4e86, \u795d\u4f60\u4f7f\u7528\u6109\u5feb! :)",time:"",footer:""}];b("#IM_About").click(function(a){a?a.stopPropagation():window.event.cancelBubble=
true;b("#IM_AboutBox").fadeIn(300)});y(document,"click",function(){b("#IM_AboutBox").fadeOut(500)},!1);b("#IM_AboutBox").click(function(){return false});b("#IM_AboutBox a").click(function(){window.open(b(this).attr("href"),"Qin Wei")})})})(jQuery);
